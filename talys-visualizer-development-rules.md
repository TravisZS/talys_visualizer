# TALYS Visualizer 开发规则

## 项目概述
TALYS Visualizer是一个桌面应用程序，用于将TALYS核反应计算代码的所有功能进行可视化。使用Python + PyQt6开发，通过Nuitka编译为原生可执行文件。

## 核心开发原则

### 1. 严格遵循TALYS默认值
- **禁止**提供"智能参数建议"
- **必须**使用从TALYS源代码提取的真实默认值
- **禁止**擅自修改或"优化"TALYS的默认参数设置
- 所有模型选择的默认值必须与TALYS原版完全一致

### 2. 分层界面设计
- **基础模式**：仅显示必需参数和最常用选项
- **高级模式**：按物理模块分组显示更多参数
- **专家模式**：提供原始输入文件编辑器
- **模板系统**：预设常用配置，但不改变默认值

### 3. 技术栈约束
- **GUI框架**：必须使用PyQt6
- **编译工具**：必须使用Nuitka编译为原生可执行文件
- **绘图库**：主要使用Matplotlib和PyQtGraph
- **数据处理**：使用NumPy和Pandas
- **禁止**使用Web技术（如Electron、Web框架等）

## 开发流程规则

### 4. 文档同步更新 ⭐
**每完成一个开发步骤，必须立即更新相关开发文档**

#### 必须更新的文档：
- `TALYS_Visualizer_Development_Plan.md` - 总体进度和里程碑
- `Phase1_Implementation_Guide.md` - 当前阶段的具体实施
- `TALYS_Default_Parameters.md` - 参数相关的更新
- `Build_and_Distribution_Guide.md` - 构建和打包相关的更新

#### 更新时机：
- ✅ **完成任何功能模块后**
- ✅ **解决重要技术问题后**
- ✅ **修改项目结构后**
- ✅ **发现新的技术约束后**
- ✅ **每周进度检查时**

#### 更新内容：
- 标记已完成的任务 `[ ]` → `[x]`
- 记录实际遇到的问题和解决方案
- 更新时间估算（如果与计划有偏差）
- 添加新发现的技术细节
- 更新代码示例和配置

### 5. 代码质量标准
- **类型提示**：所有函数必须包含类型提示
- **文档字符串**：所有类和公共方法必须有详细的docstring
- **错误处理**：必须有完善的异常处理机制
- **日志记录**：关键操作必须记录日志
- **单元测试**：核心功能必须有对应的单元测试

### 6. TALYS接口规则
- **只能**通过子进程调用TALYS可执行文件
- **禁止**修改TALYS源代码
- **必须**支持用户自定义TALYS可执行文件路径
- **必须**处理TALYS计算超时和错误情况
- **必须**正确解析TALYS的所有输出格式

### 7. 用户体验原则
- **简单优先**：默认界面应该对新手友好
- **专业完整**：高级功能不能缺失
- **响应迅速**：长时间计算必须有进度指示
- **错误友好**：错误信息必须对用户有帮助
- **跨平台**：必须在Windows、Linux、macOS上正常工作

## 开发阶段规则

### 8. Phase 1 (基础架构) 规则
- 必须先建立完整的项目结构
- TALYS接口必须在第3-4周完成并通过测试
- 参数管理系统必须支持从源代码提取默认值
- 基础GUI框架必须在第6周前可运行

### 9. Phase 2 (核心可视化) 规则
- 每个可视化组件必须独立可测试
- 图表必须支持交互（缩放、平移、数据点查看）
- 必须支持数据导出功能
- 性能要求：处理1000个数据点时响应时间<1秒

### 10. Phase 3 (高级功能) 规则
- 所有TALYS功能必须有对应的可视化
- 特殊计算模式（天体物理学、裂变等）必须完整支持
- 必须保持与基础功能的一致性

### 11. Phase 4 (打包分发) 规则
- 必须支持三大平台的自动化构建
- 安装包必须包含所有必要的依赖
- 最终用户不应需要安装Python或其他依赖
- 必须提供清晰的安装和使用文档

## 质量保证规则

### 12. 测试要求
- **单元测试覆盖率**：核心模块必须>80%
- **集成测试**：TALYS接口必须有完整的集成测试
- **用户测试**：每个里程碑必须进行用户体验测试
- **性能测试**：大数据量情况下的性能测试

### 13. 版本控制规则
- 使用语义化版本号（v1.0.0, v1.1.0等）
- 每个功能完成后必须提交代码
- 重要里程碑必须打标签
- 提交信息必须清晰描述改动内容

### 14. 发布准备规则
- 必须在至少两个不同平台上测试
- 必须有完整的用户文档
- 必须有安装和卸载测试
- 必须有错误报告和反馈机制

## 协作规则

### 15. 沟通规则
- 遇到技术难题时，必须先查阅现有文档
- 重大设计决策必须记录在开发文档中
- 进度延迟必须及时更新计划文档
- 新发现的最佳实践必须分享到团队

### 16. 问题解决流程
1. **查阅文档**：先检查现有开发文档
2. **搜索资料**：查找相关技术资料
3. **实验验证**：编写小型测试程序验证方案
4. **更新文档**：将解决方案记录到文档中
5. **代码实现**：实施经过验证的解决方案

## 禁止事项

### 17. 严格禁止
- ❌ 修改TALYS的默认参数值
- ❌ 使用Web技术栈
- ❌ 跳过文档更新步骤
- ❌ 提交未经测试的代码
- ❌ 硬编码文件路径
- ❌ 忽略错误处理
- ❌ 使用过时的依赖库版本

## 应急处理

### 18. 当遇到阻塞问题时
1. **立即记录**：在开发文档中记录问题详情
2. **寻求帮助**：向有经验的开发者咨询
3. **调整计划**：如需要，更新开发计划时间线
4. **备选方案**：准备技术备选方案
5. **经验总结**：问题解决后，更新文档避免重复

## 成功标准

### 19. 项目成功的定义
- ✅ 所有TALYS功能都有对应的可视化
- ✅ 三大平台都有可用的安装包
- ✅ 普通用户可以无技术背景使用
- ✅ 开发文档完整且与代码同步
- ✅ 通过所有质量检查点
- ✅ 社区反馈积极

---

**记住：每完成一步，立即更新文档！这是确保项目成功的关键。**
